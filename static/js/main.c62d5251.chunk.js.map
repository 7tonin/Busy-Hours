{"version":3,"sources":["config/locales sync /^/.//.*/.json$","view/Alert.js","view/InAlert.js","view/DataLoader.js","view/UserButton.js","view/Header.js","view/DaysPicker.js","view/TimePeriodPicker.js","view/PeriodEditor.js","view/HoursEditor.js","view/ContentLineTrip.js","view/NavLines.js","view/EditorsMenu.js","view/TagsTable.js","view/SummaryLineTrip.js","view/LineTrip.js","view/LoginDialog.js","view/LineList.js","view/Welcome.js","view/Body.js","ctrl/DataManager.js","index.js"],"names":["map","./be.json","./cs.json","./de.json","./en.json","./es.json","./fr.json","./hu.json","./it.json","webpackContext","req","id","webpackContextResolve","__webpack_require__","e","Error","code","keys","Object","resolve","module","exports","Alert","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","duration","message","type","open","PubSub","subscribe","msg","data","setState","details","_this2","react_default","a","createElement","Snackbar","autoHideDuration","onClose","action","IconButton","key","onClick","color","CloseIcon_default","Component","COLORS","error","red","warning","orange","info","lightBlue","ICONS","AlertCircle","Information","InAlert","level","props","icon","React","style","verticalAlign","relId","relationId","SnackbarContent","backgroundColor","margin","Button","target","href","CONFIG","osm_api_url","I18n","t","ERROR_DETAILS","cant_get_trips","many_route_masters","invalid_mode","no_trips","DataLoader","loading","match","params","rid","textAlign","padding","CircularProgress","size","view_InAlert","isNaN","parseInt","dataManager","loadDataFromRelation","then","onDataLoaded","lineIds","length","page","includes","history","location","pathname","push","catch","console","withRouter","UserButtonComponent","connected","user","menuOpen","menuAnchor","psTokens","publish","_closeMenu","display","Tooltip","title","placement","currentTarget","AccountCircleIcon_default","Menu","anchorEl","bind","MenuItem","disabled","_logoutClick","ListItemIcon","LogoutIcon_default","Typography","variant","AccountIcon_default","_this3","login","username","unsubscribe","Header","AppBar","position","Toolbar","justifyContent","cursor","src","height","window","EDITOR_NAME","alt","marginRight","UserButton","DaysPicker","locale","baseDate","Date","UTC","weekDays","i","val","toLocaleDateString","weekday","substring","toLowerCase","lbl","setDate","getDate","evt","clicked","value","newList","selection","slice","filter","v","selected","onChange","days","_getWeekDays","FormControl","component","FormLabel","label","FormGroup","_onChange","row","marginTop","d","FormControlLabel","control","Checkbox","labelPlacement","checked","TimePeriodPicker","fromDate","toDate","interval","newState","fromHour","_hourStringToDateObj","toHour","prevProps","hour","what","_callOnChange","clearTimeout","assign","setTimeout","toTimeString","onInvalid","isMobile","width","TimePicker","ampm","initialFocusedDate","className","mask","marginLeft","TextField","placeholder","InputProps","endAdornment","InputAdornment","onDelete","tabIndex","DeleteIcon_default","withWidth","PeriodEditor","intervals","showEmptyInterval","_notityParent","entries","onValid","log","prevHour","nextHour","nextInterval","newIntervals","_this4","intervalsSorted","sort","b","localeCompare","Grid","container","alignItems","item","xs","sm","view_DaysPicker","_onDaysChanged","AlarmOffIcon_default","itid","_e","slicedToArray","min","view_TimePeriodPicker","split","_editInterval","AlarmPlusIcon_default","period","deepEqual","DEFAULT_PERIOD","HoursEditor","periods","alert","notConnectedAlert","uploading","_busyPeriods","Set","withDefault","Array","isArray","linetrip","allComputedIntervals","p","newP","editor_user","editor_user_auth","_copyPeriods","_getPeriods","add","onEdit","forEach","indexOf","splice","pid","delete","saveRelationPeriods","relid","toString","clear","spacing","marginBottom","_onSend","CloudUploadIcon_default","_onCancel","CancelIcon_default","intv","Paper","view_PeriodEditor","_updatePeriod","_busyPeriod","_deletePeriod","_addPeriod","editedPeriods","psTokenLogin","psTokenLogout","ContentTripLine","tab","line","selectedLine","lines","trip","selectedTrip","trips","Tabs","newval","indicatorColor","textColor","Tab","ref","view_HoursEditor","edits","opening_hours","List","tid","ListItem","ListItemAvatar","data-transport-mode","data-transport-line-code","data-transport-line-color","colour","ListItemText","primary","dest","to","secondary","from","ListItemSecondaryAction","edge","Link","CalendarEditIcon_default","NavLines","stLink","textDecoration","Breadcrumbs","separator","aria-label","react_router_dom","rawTags","route_master","data-transport-destination","Math","toRadians","degrees","PI","toDegrees","radians","EditorsMenu","anchor","url","JOSM_URL","relation","fetch","response","ID_URL","hashtags","replace","encodeURIComponent","join","focus","editor","_onClose","_editId","_editJOSM","editors","name","tip","_click","keepMounted","TagsTable","overflowX","Table","TableHead","TableRow","TableCell","TableBody","tags","SummaryTripLine","showTags","network","operator","defaultInterval","opens","otherIntervals","view_TagsTable","view_EditorsMenu","LineTrip","theProps","lid","react_router","when","view_NavLines","SummaryLineTrip","ContentLineTrip","_checkDataLoaded","LoginDialogComponent","_closeDialog","backToHome","Dialog","DialogTitle","DialogContent","DialogContentText","DialogActions","_loginClicked","autoFocus","LineList","ts","button","Welcome","searchText","trim","MagnifyIcon_default","previousLines","view_LineList","refs","relnumber","addEventListener","Body","_theme","createMuiTheme","palette","blue","light","main","dark","JSON","parse","localStorage","getItem","newData","inStore","_getPreviousLinesInStorage","toAppend","floor","now","setItem","stringify","MuiPickersUtilsProvider","utils","DateFnsUtils","ThemeProvider","theme","view_Header","Container","maxWidth","exact","path","render","view_Welcome","view_DataLoader","_onDataLoaded","view_LineTrip","LoginDialog","view_Alert","VALID_MODES","DataManager","_osmApi","OsmRequest","endpoint","oauthConsumerKey","oauth_consumer_key","oauthSecret","oauth_secret","_transportHours","TransportHours","reltags","result","tagsToHoursObject","route","defineProperty","Promise","reject","fetchElement","relTags","getTags","transportMode","fetchRelationsForElement","parentRelations","routeMasters","r","otherTripsRel","member","m","$","all","tr","otherTripsData","_createSimplifiedLineTrip","apply","concat","toConsumableArray","tripsRel","allPeriods","_auth","newTags","intervalsObjectToTags","osmElement","_context","t1","createChangeset","PACKAGE","version","host","EDITOR_URL","changesetId","t2","setTags","setTimestampToNow","sendElement","t3","closeChangeset","editor_name","LOCALES","origin","lastIndexOf","App","_initI18n","_initCtrl","_initView","_initAuth","navigator","languages","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","l","err","return","userLanguage","language","fallbacks","_i","_LOCALES","translations","require","_dataManager","ReactDOM","view_Body","document","getElementById","opts","landing","hash","singlepage","OsmAuth","token","_readURLParams","oauth_token","bootstrapToken","_checkAuth","pushState","authWait","setInterval","options","authenticated","authenticate","res","logout","removeItem","clearInterval","xhr","method","firstChild","childNodes","attributes","display_name","auth","str","u","pair","reduce","obj","parts","decodeURIComponent"],"mappings":"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","file":"static/js/main.c62d5251.chunk.js","sourcesContent":["var map = {\n\t\"./be.json\": 210,\n\t\"./cs.json\": 211,\n\t\"./de.json\": 212,\n\t\"./en.json\": 213,\n\t\"./es.json\": 214,\n\t\"./fr.json\": 215,\n\t\"./hu.json\": 216,\n\t\"./it.json\": 217\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) { // check for number or string\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn id;\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 209;","import React, { Component } from 'react';\nimport Close from 'mdi-react/CloseIcon';\nimport IconButton from '@material-ui/core/IconButton';\nimport PubSub from 'pubsub-js';\nimport Snackbar from '@material-ui/core/Snackbar';\n\n/**\n * Alert component handles non-blocking dialogs display to user.\n * This component listens to {@link Events|UI.MESSAGE.BASIC} events.\n */\nclass Alert extends Component {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.state = {\n\t\t\tduration: 5000,\n\t\t\tmessage: \"\",\n\t\t\ttype: \"info\",\n\t\t\topen: false\n\t\t};\n\n\t\tPubSub.subscribe(\"UI.MESSAGE.BASIC\", (msg, data) => {\n\t\t\tthis.setState({\n\t\t\t\tmessage: data.message+(data.details ? \" (\"+data.details+\")\" : \"\"),\n\t\t\t\tduration: data.duration || (data.details ? 7000 : 5000),\n\t\t\t\ttype: data.type || \"info\",\n\t\t\t\topen: true\n\t\t\t});\n\t\t});\n\t}\n\n\trender() {\n\t\treturn <Snackbar\n\t\t\topen={this.state.open}\n\t\t\tautoHideDuration={this.state.duration}\n\t\t\tonClose={() => this.setState({ open: false })}\n\t\t\tmessage={this.state.message}\n\t\t\taction={[\n\t\t\t\t<IconButton\n\t\t\t\t\tkey=\"close\"\n\t\t\t\t\tonClick={() => this.setState({ open: false })}\n\t\t\t\t\tcolor=\"inherit\"\n\t\t\t\t>\n\t\t\t\t\t<Close />\n\t\t\t\t</IconButton>\n\t\t\t]}\n\t\t/>;\n\t}\n}\n\nexport default Alert;\n\n/**\n * Event for displaying a non-blocking message to user.\n * @event UI.MESSAGE.BASIC\n * @type {Object} Event data\n * @property {string} [type] The kind of message (error, alert, info). Defaults to info.\n * @property {string} message The message text.\n * @property {int} [duration] The message display duration in milliseconds. Defaults to 3000.\n * @memberof App\n */\n","import React, { Component } from 'react';\nimport Alert from 'mdi-react/AlertIcon';\nimport AlertCircle from 'mdi-react/AlertCircleIcon';\nimport Button from '@material-ui/core/Button';\nimport CONFIG from '../config/config.json';\nimport I18n from 'i18nline/lib/i18n';\nimport Information from 'mdi-react/InformationIcon';\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\nimport lightBlue from '@material-ui/core/colors/lightBlue';\nimport orange from '@material-ui/core/colors/orange';\nimport red from '@material-ui/core/colors/red';\n\nconst COLORS = { \"error\": red[600], \"warning\": orange[600], \"info\": lightBlue[600] };\nconst ICONS = { \"error\": AlertCircle, \"warning\": Alert, \"info\": Information };\n\n/**\n * In alert displays a not-so important message to user inline.\n * @property {string} message The text to display\n * @property {string} [level] Importance level (info, warning, error)\n * @property {Component} [icon] An icon to display\n */\nclass InAlert extends Component {\n\trender() {\n\t\tconst level = this.props.level || \"info\";\n\t\tconst icon = this.props.icon || React.createElement(ICONS[level], { style: {verticalAlign: \"middle\"} });\n\t\tconst relId = this.props.relationId || null;\n\n\t\treturn <SnackbarContent\n\t\t\tmessage={\n\t\t\t\t<div>{icon} {this.props.message}</div>\n\t\t\t}\n\t\t\tstyle={{backgroundColor: COLORS[level], color: \"white\", verticalAlign: \"middle\", margin: 10}}\n\t\t\taction={relId ? [\n\t\t\t\t<Button\n\t\t\t\t\tkey=\"osm\"\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\tcolor=\"inherit\"\n\t\t\t\t\thref={CONFIG.osm_api_url+\"/relation/\"+relId}\n\t\t\t\t>\n\t\t\t\t\t{I18n.t(\"See relation details on OSM\")}\n\t\t\t\t</Button>\n\t\t\t] : null}\n\t\t>\n\t\t</SnackbarContent>;\n\t}\n}\n\nexport default InAlert;\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport I18n from 'i18nline/lib/i18n';\nimport InAlert from './InAlert';\n\nconst ERROR_DETAILS = {\n\t\"cant_get_trips\": I18n.t(\"OSM API can't retrieve all trips associated to this line.\"),\n\t\"many_route_masters\": I18n.t(\"This line is not consistent : many route_master relations are associated to this line.\"),\n\t\"invalid_mode\": I18n.t(\"This line is using a transport mode which is not handled (maybe incorrect ?).\"),\n\t\"no_trips\": I18n.t(\"This route master doesn't have any route associated.\")\n};\n\n/**\n * DataLoader is a component for calling DataManager to load wanted relation.\n * It also shows some waiting widget to user.\n */\nclass DataLoader extends Component {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.state = {\n\t\t\tloading: true,\n\t\t\terror: false\n\t\t};\n\t}\n\n\trender() {\n\t\tconst relId = this.props.match.params.rid;\n\t\treturn <div style={{textAlign: \"center\", padding: 30}}>\n\t\t\t{this.state.loading &&\n\t\t\t\t<CircularProgress size={50} />\n\t\t\t}\n\n\t\t\t{this.state.error && ERROR_DETAILS[this.state.error] &&\n\t\t\t\t<InAlert\n\t\t\t\t\tmessage={ERROR_DETAILS[this.state.error]}\n\t\t\t\t\trelationId={relId}\n\t\t\t\t\tlevel=\"error\"\n\t\t\t\t/>\n\t\t\t}\n\n\t\t\t{this.state.error === \"invalid_id\" &&\n\t\t\t\t<InAlert\n\t\t\t\t\tmessage={I18n.t(\"The given relation ID is invalid. Please only give the number in the relation ID (example : 1234).\")}\n\t\t\t\t\tlevel=\"warning\"\n\t\t\t\t/>\n\t\t\t}\n\n\t\t\t{this.state.error === \"api_failed\" &&\n\t\t\t\t<InAlert\n\t\t\t\t\tmessage={I18n.t(\"Oops ! OpenStreetMap API seems unavailable. Please retry a bit later.\")}\n\t\t\t\t\tlevel=\"error\"\n\t\t\t\t/>\n\t\t\t}\n\t\t</div>;\n\t}\n\n\tcomponentDidMount() {\n\t\tconst relId = this.props.match.params.rid;\n\t\tif(!isNaN(parseInt(relId))) {\n\t\t\tthis.setState({ loading: true, error: false });\n\n\t\t\t// Load the relation\n\t\t\tthis.props.dataManager\n\t\t\t.loadDataFromRelation(\"relation/\"+relId)\n\t\t\t.then(data => {\n\t\t\t\tthis.setState({ loading: false, error: false });\n\t\t\t\tthis.props.onDataLoaded(data);\n\n\t\t\t\t// Redirect to proper page\n\t\t\t\tconst lineIds = Object.keys(data);\n\t\t\t\tif(lineIds.length > 0) {\n\t\t\t\t\tconst page = lineIds.includes(relId) ? \"/line/\" + relId : \"/line/\" + lineIds[0] + \"/trip/\" + relId;\n\n\t\t\t\t\tif(this.props.history.location.pathname !== page) {\n\t\t\t\t\t\tthis.props.history.push(page);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tthis.setState({ loading: false, error: ERROR_DETAILS[error] ? error : \"api_failed\" });\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tthis.setState({ loading: false, error: \"invalid_id\" });\n\t\t}\n\t}\n}\n\nexport default withRouter(DataLoader);\n","import React, { Component } from 'react';\nimport Account from 'mdi-react/AccountIcon';\nimport AccountCircle from 'mdi-react/AccountCircleIcon';\nimport Logout from 'mdi-react/LogoutIcon';\nimport Button from '@material-ui/core/Button';\nimport I18n from 'i18nline/lib/i18n';\nimport IconButton from '@material-ui/core/IconButton';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport PubSub from 'pubsub-js';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\n\n/**\n * User button component handles switching between multiple states of user connection.\n */\nclass UserButtonComponent extends Component {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.state = {\n\t\t\tconnected: false,\n\t\t\tuser: null,\n\t\t\tmenuOpen: false,\n\t\t\tmenuAnchor: null\n\t\t};\n\n\t\tthis.psTokens = {};\n\t}\n\n\t/**\n\t * Closes the menu.\n\t * @private\n\t */\n\t_closeMenu() {\n\t\tthis.setState({ menuOpen: false, menuAnchor: null });\n\t}\n\n\t/**\n\t * Handler for logout click.\n\t * @private\n\t */\n\t_logoutClick() {\n\t\tPubSub.publish(\"APP.USER.LOGOUT\");\n\t\tthis._closeMenu();\n\t\tthis.setState({ connected: false, user: null });\n\t}\n\n\trender() {\n\t\tif(this.state.connected) {\n\t\t\treturn <div style={{display: \"inline\"}}>\n\t\t\t\t<Tooltip title={I18n.t(\"Account\")} placement=\"bottom\">\n\t\t\t\t\t<IconButton\n\t\t\t\t\t\tcolor=\"inherit\"\n\t\t\t\t\t\tonClick={e => this.setState({ menuOpen: true, menuAnchor: e.currentTarget })}\n\t\t\t\t\t>\n\t\t\t\t\t\t<AccountCircle />\n\t\t\t\t\t</IconButton>\n\t\t\t\t</Tooltip>\n\t\t\t\t<Menu\n\t\t\t\t\tanchorEl={this.state.menuAnchor}\n\t\t\t\t\topen={this.state.menuOpen}\n\t\t\t\t\tonClose={this._closeMenu.bind(this)}\n\t\t\t\t>\n\t\t\t\t\t<MenuItem disabled>{this.state.user}</MenuItem>\n\t\t\t\t\t<MenuItem onClick={this._logoutClick.bind(this)}>\n\t\t\t\t\t\t<ListItemIcon>\n\t\t\t\t\t\t\t<Logout />\n\t\t\t\t\t\t</ListItemIcon>\n\t\t\t\t\t\t<Typography variant=\"inherit\">{I18n.t(\"Log Out\")}</Typography>\n\t\t\t\t\t</MenuItem>\n\t\t\t\t</Menu>\n\t\t\t</div>;\n\t\t}\n\t\telse {\n\t\t\treturn <Tooltip title={I18n.t(\"Log In\")} placement=\"bottom\">\n\t\t\t\t<Button\n\t\t\t\t\tcolor=\"inherit\"\n\t\t\t\t\tonClick={() => PubSub.publish(\"APP.USER.WANTSLOGIN\")}\n\t\t\t\t>\n\t\t\t\t\t<Account />\n\t\t\t\t\t{I18n.t(\"Log In\")}\n\t\t\t\t</Button>\n\t\t\t</Tooltip>;\n\t\t}\n\t}\n\n\tcomponentWillMount() {\n\t\tthis.psTokens.login = PubSub.subscribe(\"APP.USER.READY\", (msg, data) => {\n\t\t\tthis.setState({ user: data.username, connected: true });\n\t\t});\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif(this.psTokens.login) {\n\t\t\tPubSub.unsubscribe(this.psTokens.login);\n\t\t}\n\t}\n}\n\nexport default UserButtonComponent;\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport UserButton from './UserButton';\n\n/**\n * Header component is the navigation toolbar on top of page.\n */\nclass Header extends Component {\n\trender() {\n\t\treturn <AppBar position=\"static\" style={{backgroundColor: \"#0267b1\"}}>\n\t\t\t<Toolbar style={{justifyContent: \"space-between\"}}>\n\t\t\t\t<div style={{cursor: \"pointer\"}} onClick={() => this.props.history.push('/')}>\n\t\t\t\t\t<img\n\t\t\t\t\t\tsrc=\"header.png\"\n\t\t\t\t\t\theight={64}\n\t\t\t\t\t\ttitle={window.EDITOR_NAME}\n\t\t\t\t\t\talt=\"\"\n\t\t\t\t\t\tstyle={{verticalAlign: \"middle\", marginRight: 10}}\n\t\t\t\t\t/>\n\t\t\t\t\t<Typography variant=\"h6\" style={{display: \"inline-block\"}}>\n\t\t\t\t\t\t{window.EDITOR_NAME}\n\t\t\t\t\t</Typography>\n\t\t\t\t</div>\n\n\t\t\t\t<UserButton />\n\t\t\t</Toolbar>\n\t\t</AppBar>;\n\t}\n}\n\nexport default withRouter(Header);\n","import React, { Component } from 'react';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport I18n from 'i18nline/lib/i18n';\n\n/**\n * DaysPicker allows to select days in a week.\n * Shown days are localized thanks to `toLocaleDateString` browser method.\n *\n * @property {string} label Label for the field\n * @property {string[]} selection Values to show as selected\n * @property {function} [onChange] Handler for value changes\n */\nclass DaysPicker extends Component {\n\t_getWeekDays(locale) {\n\t\tlet baseDate = new Date(Date.UTC(2017, 0, 2)); // just a Monday\n\t\tconst weekDays = [];\n\n\t\tfor(let i = 0; i < 7; i++) {\n\t\t\tweekDays.push({\n\t\t\t\tval: baseDate.toLocaleDateString(\"en-GB\", { weekday: \"long\" }).substring(0, 2).toLowerCase(),\n\t\t\t\tlbl: baseDate.toLocaleDateString(locale, { weekday: \"short\" })\n\t\t\t});\n\t\t\tbaseDate.setDate(baseDate.getDate() + 1);\n\t\t}\n\n\t\tweekDays.push({ val: \"ph\", lbl: I18n.t(\"PH\") });\n\n\t\treturn weekDays;\n\t}\n\n\t_onChange(evt) {\n\t\tconst clicked = evt.target.value;\n\t\tlet newList = this.props.selection.slice(0);\n\n\t\tif(!this.props.selection.includes(clicked)) {\n\t\t\tnewList.push(clicked);\n\t\t}\n\t\telse {\n\t\t\tnewList = newList.filter(v => v !== clicked);\n\t\t}\n\n\t\tthis.setState({ selected: newList });\n\n\t\tif(this.props.onChange) {\n\t\t\tthis.props.onChange(newList);\n\t\t}\n\t}\n\n\trender() {\n\t\tconst days = this._getWeekDays(I18n.locale);\n\n\t\treturn <FormControl component=\"fieldset\">\n\t\t\t<FormLabel component=\"legend\">{this.props.label}</FormLabel>\n\t\t\t<FormGroup\n\t\t\t\tvalue={this.props.value}\n\t\t\t\tonChange={e => this._onChange(e)}\n\t\t\t\trow\n\t\t\t\tstyle={{marginTop: 5}}\n\t\t\t>\n\t\t\t\t{days.map(d => (\n\t\t\t\t\t<FormControlLabel\n\t\t\t\t\t\tkey={d.val}\n\t\t\t\t\t\tvalue={d.val}\n\t\t\t\t\t\tcontrol={<Checkbox color=\"primary\" />}\n\t\t\t\t\t\tlabel={d.lbl}\n\t\t\t\t\t\tlabelPlacement=\"top\"\n\t\t\t\t\t\tstyle={{margin: 0}}\n\t\t\t\t\t\tchecked={this.props.selection.includes(d.val)}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</FormGroup>\n\t\t</FormControl>;\n\t}\n}\n\nexport default DaysPicker;\n","import React, { Component } from 'react';\nimport IconButton from '@material-ui/core/IconButton';\nimport Delete from 'mdi-react/DeleteIcon';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport FormControl from '@material-ui/core/FormControl';\nimport I18n from 'i18nline/lib/i18n';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport TextField from '@material-ui/core/TextField';\nimport { KeyboardTimePicker, TimePicker } from \"@material-ui/pickers\";\nimport withWidth from '@material-ui/core/withWidth';\n\n/**\n * TimePeriodPicker allows to select an hour range.\n */\nclass TimePeriodPicker extends Component {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.state = {\n\t\t\tfromDate: null,\n\t\t\ttoDate: null,\n\t\t\tinterval: \"\"\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tconst newState = {};\n\n\t\tif(this.props.fromHour) {\n\t\t\tnewState.fromDate = this._hourStringToDateObj(this.props.fromHour);\n\t\t}\n\n\t\tif(this.props.toHour) {\n\t\t\tnewState.toDate = this._hourStringToDateObj(this.props.toHour);\n\t\t}\n\n\t\tif(this.props.interval) {\n\t\t\tnewState.interval = this.props.interval;\n\t\t}\n\n\t\tthis.setState(newState);\n\t}\n\n\tcomponentDidUpdate(prevProps) {\n\t\tconst newState = {};\n\n\t\tif(prevProps.fromHour !== this.props.fromHour) {\n\t\t\tnewState.fromDate = this._hourStringToDateObj(this.props.fromHour);\n\t\t}\n\n\t\tif(prevProps.toHour !== this.props.toHour) {\n\t\t\tnewState.toDate = this._hourStringToDateObj(this.props.toHour);\n\t\t}\n\n\t\tif(prevProps.interval !== this.props.interval) {\n\t\t\tnewState.interval = this.props.interval;\n\t\t}\n\n\t\tif(Object.keys(newState).length > 0) {\n\t\t\tthis.setState(newState);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_hourStringToDateObj(hour) {\n\t\treturn hour ? new Date(\"1970-01-01T\"+hour+\":00\") : null;\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_onChange(what, value) {\n\t\tif(this._callOnChange) {\n\t\t\tclearTimeout(this._callOnChange);\n\t\t\tdelete this._callOnChange;\n\t\t}\n\n\t\tconst newState = Object.assign({}, this.state);\n\t\tnewState[what] = value;\n\n\t\tif(newState.fromDate instanceof Date && newState.toDate instanceof Date && !isNaN(parseInt(newState.interval))) {\n\t\t\tthis._callOnChange = setTimeout(() => {\n\t\t\t\tconst fromHour = newState.fromDate.toTimeString().substring(0,5);\n\t\t\t\tconst toHour = newState.toDate.toTimeString().substring(0,5);\n\t\t\t\tthis.props.onChange(fromHour + \"-\" + toHour, parseInt(newState.interval));\n\t\t\t}, 1000);\n\t\t}\n\t\telse {\n\t\t\tthis.props.onInvalid();\n\t\t}\n\n\t\tthis.setState(newState);\n\t}\n\n\trender() {\n\t\tconst isMobile = this.props.width === \"xs\";\n\n\t\treturn <FormControl component=\"fieldset\" style={{display: \"block\"}}>\n\t\t\t<FormGroup\n\t\t\t\tvalue={this.props.value}\n\t\t\t\trow\n\t\t\t\tstyle={{marginTop: 5, display: \"flex\", justifyContent: \"space-between\"}}\n\t\t\t>\n\t\t\t\t{isMobile ?\n\t\t\t\t\t<TimePicker\n\t\t\t\t\t\tampm={false}\n\t\t\t\t\t\tinitialFocusedDate={new Date(\"1970-01-01T00:00:00\")}\n\t\t\t\t\t\tvalue={this.state.fromDate}\n\t\t\t\t\t\tlabel={I18n.t(\"From\")}\n\t\t\t\t\t\tstyle={{width: 80}}\n\t\t\t\t\t\tonChange={d => this._onChange(\"fromDate\", d)}\n\t\t\t\t\t/>\n\t\t\t\t\t:\n\t\t\t\t\t<KeyboardTimePicker\n\t\t\t\t\t\tclassName=\"time-picker-no-icon\"\n\t\t\t\t\t\tampm={false}\n\t\t\t\t\t\tlabel={I18n.t(\"From\")}\n\t\t\t\t\t\tmask=\"__:__\"\n\t\t\t\t\t\tvalue={this.state.fromDate}\n\t\t\t\t\t\tstyle={{width: 80}}\n\t\t\t\t\t\tonChange={d => this._onChange(\"fromDate\", d)}\n\t\t\t\t\t/>\n\t\t\t\t}\n\n\t\t\t\t{isMobile ?\n\t\t\t\t\t<TimePicker\n\t\t\t\t\t\tampm={false}\n\t\t\t\t\t\tinitialFocusedDate={new Date(\"1970-01-01T00:00:00\")}\n\t\t\t\t\t\tvalue={this.state.toDate}\n\t\t\t\t\t\tlabel={I18n.t(\"To\")}\n\t\t\t\t\t\tstyle={{marginRight: 20, marginLeft: 20, width: 80}}\n\t\t\t\t\t\tonChange={d => this._onChange(\"toDate\", d)}\n\t\t\t\t\t/>\n\t\t\t\t\t:\n\t\t\t\t\t<KeyboardTimePicker\n\t\t\t\t\t\tclassName=\"time-picker-no-icon\"\n\t\t\t\t\t\tampm={false}\n\t\t\t\t\t\tlabel={I18n.t(\"To\")}\n\t\t\t\t\t\tmask=\"__:__\"\n\t\t\t\t\t\tvalue={this.state.toDate}\n\t\t\t\t\t\tstyle={{marginRight: 20, marginLeft: 20, width: 80}}\n\t\t\t\t\t\tonChange={d => this._onChange(\"toDate\", d)}\n\t\t\t\t\t/>\n\t\t\t\t}\n\n\t\t\t\t<TextField\n\t\t\t\t\tlabel={I18n.t(\"Interval\")}\n\t\t\t\t\tvalue={this.state.interval}\n\t\t\t\t\tplaceholder=\"42\"\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t\tInputProps={{\n\t\t\t\t\t\tendAdornment: <InputAdornment position=\"end\">min</InputAdornment>,\n\t\t\t\t\t}}\n\t\t\t\t\tstyle={{width: 150}}\n\t\t\t\t\tonChange={evt => this._onChange(\"interval\", evt.target.value)}\n\t\t\t\t/>\n\n\t\t\t\t<IconButton\n\t\t\t\t\ttitle={I18n.t(\"Delete this interval\")}\n\t\t\t\t\tsize=\"small\"\n\t\t\t\t\tstyle={{marginLeft: 10}}\n\t\t\t\t\tonClick={() => this.props.onDelete()}\n\t\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t>\n\t\t\t\t\t<Delete />\n\t\t\t\t</IconButton>\n\t\t\t</FormGroup>\n\t\t</FormControl>;\n\t}\n}\n\nexport default withWidth()(TimePeriodPicker);\n","import React, { Component } from 'react';\nimport AlarmOff from 'mdi-react/AlarmOffIcon';\nimport AlarmPlus from 'mdi-react/AlarmPlusIcon';\nimport Button from '@material-ui/core/Button';\nimport DaysPicker from './DaysPicker';\nimport deepEqual from 'fast-deep-equal';\nimport Grid from '@material-ui/core/Grid';\nimport I18n from 'i18nline/lib/i18n';\nimport TimePeriodPicker from './TimePeriodPicker';\n\n/**\n * Period editor allows to edit days and intervals of a single period.\n */\nclass PeriodEditor extends Component {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.state = {\n\t\t\tdays: [],\n\t\t\tintervals: null,\n\t\t\tshowEmptyInterval: false\n\t\t};\n\t}\n\n\t_onDaysChanged(days) {\n\t\tthis.setState({ days: days }, () => this._notityParent());\n\t}\n\n\t_notityParent() {\n\t\tif(\n\t\t\t!this.state.showEmptyInterval\n\t\t\t&& this.state.days.length > 0\n\t\t\t&& this.state.intervals\n\t\t\t&& Object.keys(this.state.intervals).length > 0\n\t\t\t&& Object.entries(this.state.intervals).filter(e => !e[0].match(/^\\d{2}:\\d{2}-\\d{2}:\\d{2}$/) || isNaN(e[1])).length === 0\n\t\t) {\n\t\t\tthis.props.onValid({ days: this.state.days, intervals: this.state.intervals });\n\t\t}\n\t\telse {\n\t\t\tconsole.log(\"invalid\", this.state);\n\t\t\tthis.props.onInvalid();\n\t\t}\n\t}\n\n\t_editInterval(prevHour, nextHour, nextInterval) {\n\t\tconst newIntervals = this.state.intervals === null ? {} : Object.assign({}, this.state.intervals);\n\n\t\tif(prevHour) {\n\t\t\tdelete newIntervals[prevHour];\n\t\t}\n\n\t\tif(nextHour) {\n\t\t\tnewIntervals[nextHour] = nextInterval || null;\n\t\t}\n\n\t\tthis.setState({ intervals: Object.keys(newIntervals).length > 0 ? newIntervals : null }, () => this._notityParent());\n\t}\n\n\trender() {\n\t\tconst intervalsSorted = this.state.intervals ? Object.entries(this.state.intervals).sort((a,b) => a[0].localeCompare(b[0])) : [];\n\n\t\treturn <Grid container alignItems=\"center\">\n\t\t\t<Grid item xs={12} sm={6}>\n\t\t\t\t<DaysPicker\n\t\t\t\t\tlabel={I18n.t(\"Days concerned\")}\n\t\t\t\t\tselection={this.state.days}\n\t\t\t\t\tonChange={days => this._onDaysChanged(days)}\n\t\t\t\t/>\n\n\t\t\t\t<Button\n\t\t\t\t\tstyle={{marginTop: 10}}\n\t\t\t\t\tonClick={() => this.props.onDelete()}\n\t\t\t\t>\n\t\t\t\t\t<AlarmOff /> {I18n.t(\"Delete this period\")}\n\t\t\t\t</Button>\n\t\t\t</Grid>\n\t\t\t<Grid item xs={12} sm={6}>\n\t\t\t\t{intervalsSorted.map((e,itid) => {\n\t\t\t\t\tconst [ hour, min ] = e;\n\t\t\t\t\treturn <TimePeriodPicker\n\t\t\t\t\t\tfromHour={hour.split(\"-\")[0]}\n\t\t\t\t\t\ttoHour={hour.split(\"-\")[1]}\n\t\t\t\t\t\tinterval={min}\n\t\t\t\t\t\tkey={itid}\n\t\t\t\t\t\tonChange={(nextHour, nextInterval) => this._editInterval(hour, nextHour, nextInterval)}\n\t\t\t\t\t\tonDelete={() => this._editInterval(hour)}\n\t\t\t\t\t\tonInvalid={() => this.props.onInvalid()}\n\t\t\t\t\t/>;\n\t\t\t\t})}\n\n\t\t\t\t{this.state.showEmptyInterval &&\n\t\t\t\t\t<TimePeriodPicker\n\t\t\t\t\t\tfromHour={intervalsSorted.length > 0 ? intervalsSorted[intervalsSorted.length-1][0].split(\"-\")[1] : null}\n\t\t\t\t\t\tonChange={(nextHour, nextInterval) => {\n\t\t\t\t\t\t\tthis.setState({ showEmptyInterval: false }, () => {\n\t\t\t\t\t\t\t\tthis._editInterval(null, nextHour, nextInterval);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonDelete={() => this.setState({ showEmptyInterval: false })}\n\t\t\t\t\t\tonInvalid={() => this.props.onInvalid()}\n\t\t\t\t\t/>\n\t\t\t\t}\n\n\t\t\t\t<Button\n\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\tstyle={{marginTop: 10}}\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tthis.props.onInvalid();\n\t\t\t\t\t\tthis.setState({ showEmptyInterval: true });\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<AlarmPlus /> {I18n.t(\"Add a new interval\")}\n\t\t\t\t</Button>\n\t\t\t</Grid>\n\t\t</Grid>;\n\t}\n\n\tcomponentDidMount() {\n\t\tif(this.props.period) {\n\t\t\tthis.setState(this.props.period);\n\t\t}\n\t}\n\n\tcomponentDidUpdate(prevProps) {\n\t\tif(this.props.period) {\n\t\t\tif(!prevProps.period || !prevProps.period.days || !deepEqual(prevProps.period.days, this.props.period.days)) {\n\t\t\t\tthis.setState({ days: this.props.period.days });\n\t\t\t}\n\n\t\t\tif(!prevProps.period || !prevProps.period.intervals || !deepEqual(prevProps.period.intervals, this.props.period.intervals)) {\n\t\t\t\tthis.setState({ intervals: this.props.period.intervals });\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tthis.setState({ days: [], intervals: {} });\n\t\t}\n\t}\n}\n\nexport default PeriodEditor;\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport AlarmPlus from 'mdi-react/AlarmPlusIcon';\nimport Button from '@material-ui/core/Button';\nimport Cancel from 'mdi-react/CancelIcon';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport CloudUpload from 'mdi-react/CloudUploadIcon';\nimport deepEqual from 'fast-deep-equal';\nimport Grid from '@material-ui/core/Grid';\nimport I18n from 'i18nline/lib/i18n';\nimport InAlert from './InAlert';\nimport Paper from '@material-ui/core/Paper';\nimport PeriodEditor from './PeriodEditor';\nimport PubSub from 'pubsub-js';\n\nconst DEFAULT_PERIOD = { days: [\"mo\",\"tu\",\"we\",\"th\",\"fr\"], intervals: {} };\n\n/**\n * HoursEditor component display opening hours and frequencies of current transport line/trip.\n */\nclass HoursEditor extends Component {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.state = {\n\t\t\tperiods: null,\n\t\t\talert: null,\n\t\t\tnotConnectedAlert: false,\n\t\t\tuploading: false\n\t\t};\n\n\t\tthis._busyPeriods = new Set();\n\t}\n\n\t/**\n\t * Choose correct periods set from properties, state or default\n\t * @private\n\t */\n\t_getPeriods(withDefault) {\n\t\treturn this.state.periods || (Array.isArray(this.props.linetrip.allComputedIntervals) && this.props.linetrip.allComputedIntervals) || (withDefault ? [ DEFAULT_PERIOD ] : []);\n\t}\n\n\t/**\n\t * Create a shallow copy of given periods object for editing\n\t * @private\n\t */\n\t_copyPeriods(periods) {\n\t\treturn periods.slice(0).map(p => {\n\t\t\tconst newP = Object.assign({}, p);\n\t\t\tnewP.days = p.days.slice(0);\n\t\t\tnewP.intervals = Object.assign({}, p.intervals);\n\t\t\treturn newP;\n\t\t});\n\t}\n\n\t/**\n\t * Create a new period\n\t * @private\n\t */\n\t_addPeriod() {\n\t\tif(!window.editor_user || !window.editor_user_auth) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst periods = this._copyPeriods(this._getPeriods());\n\n\t\tif(periods.length === 0) {\n\t\t\tthis._busyPeriods.add(0);\n\t\t\tthis.props.onEdit([ DEFAULT_PERIOD ]);\n\t\t}\n\t\telse {\n\t\t\t// Find first unused day\n\t\t\tconst days = [ \"mo\", \"tu\", \"we\", \"th\", \"fr\", \"sa\", \"su\", \"ph\" ];\n\t\t\tperiods.forEach(p => {\n\t\t\t\tp.days.forEach(d => {\n\t\t\t\t\tconst id = days.indexOf(d);\n\t\t\t\t\tif(id >= 0) {\n\t\t\t\t\t\tdays.splice(id, 1);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// Create new period\n\t\t\tperiods.push({\n\t\t\t\tdays: days.length > 0 ? [ days[0] ] : [],\n\t\t\t\tintervals: {}\n\t\t\t});\n\n\t\t\tthis._busyPeriods.add(periods.length-1);\n\t\t\tthis.props.onEdit(periods);\n\t\t}\n\t}\n\n\t/**\n\t * Changes a period definition\n\t * @private\n\t */\n\t_updatePeriod(pid, period) {\n\t\tif(!window.editor_user || !window.editor_user_auth) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst periods = this._copyPeriods(this._getPeriods());\n\n\t\tif(periods[pid]) {\n\t\t\tperiods[pid] = period;\n\t\t\tthis._busyPeriods.delete(pid);\n\t\t\tthis.props.onEdit(periods);\n\t\t}\n\t}\n\n\t_busyPeriod(pid) {\n\t\tthis._busyPeriods.add(pid);\n\t}\n\n\t/**\n\t * Delete a given period\n\t * @private\n\t */\n\t_deletePeriod(pid) {\n\t\tif(!window.editor_user || !window.editor_user_auth) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst periods = this._copyPeriods(this._getPeriods());\n\n\t\tif(periods[pid]) {\n\t\t\tperiods.splice(pid, 1);\n\t\t\tthis._busyPeriods.delete(pid);\n\t\t\tthis.props.onEdit(periods);\n\t\t}\n\t}\n\n\t/**\n\t * Event handler after click on send button\n\t * @private\n\t */\n\t_onSend() {\n\t\tif(this._busyPeriods.size > 0) {\n\t\t\tPubSub.publish(\"UI.MESSAGE.BASIC\", { message: I18n.t(\"Some periods are incomplete, please check your data before uploading\") });\n\t\t}\n\t\telse if(this.state.periods.length === 0) {\n\t\t\tPubSub.publish(\"UI.MESSAGE.BASIC\", { message: I18n.t(\"No period has been added, please add information about this line opening hours\") });\n\t\t}\n\t\telse if(this.state.periods && this.props.dataManager) {\n\t\t\tthis.setState({ uploading: true });\n\n\t\t\tthis.props.dataManager\n\t\t\t.saveRelationPeriods(\"relation/\"+this.props.relid, this.state.periods)\n\t\t\t.then(() => {\n\t\t\t\t// Clear tmp data\n\t\t\t\tthis.props.onEdit(null);\n\t\t\t\tthis.setState({ periods: null, uploading: false }, () => {\n\t\t\t\t\t// Show success message\n\t\t\t\t\talert(I18n.t(\"Your edits were successfully sent to OSM\"));\n\n\t\t\t\t\t// Redirect to data loader\n\t\t\t\t\tthis.props.history.push(\"/load/\"+this.props.relid);\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\t// Show failure message\n\t\t\t\tlet message = e.message ? e.message : e.toString();\n\t\t\t\tif(message === \"not_connected\") { message = I18n.t(\"You have to be connected before sending your edits\"); }\n\t\t\t\telse if(message === \"changeset_failed\") { message = I18n.t(\"OSM server is not able to create a changeset for now\"); }\n\t\t\t\telse if(message === \"cant_find_relation\") { message = I18n.t(\"This public transport route is not available on OSM server\"); }\n\t\t\t\telse if(message === \"sending_failed\") { message = I18n.t(\"An error happened when sending your changes to OSM server\"); }\n\n\t\t\t\tthis.setState({ uploading: false, alert: { message: message } }, () => {\n\t\t\t\t\tsetTimeout(() => this.setState({ alert: null }), 5000);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Event handler after cancel button click\n\t * @private\n\t */\n\t_onCancel() {\n\t\tthis.setState({ periods: null });\n\t\tthis._busyPeriods.clear();\n\t\tthis.props.onEdit(null);\n\t}\n\n\trender() {\n\t\tif(this.state.uploading) {\n\t\t\treturn <div style={{marginTop: 10, textAlign: \"center\"}}>\n\t\t\t\t<CircularProgress style={{verticalAlign: \"middle\", marginRight: 10}} /> {I18n.t(\"Uploading your edits\")}\n\t\t\t</div>;\n\t\t}\n\t\telse {\n\t\t\tconst periods = this._getPeriods();\n\n\t\t\treturn <div style={{marginTop: 10}}>\n\t\t\t\t{this.state.alert &&\n\t\t\t\t\t<InAlert\n\t\t\t\t\t\tlevel={this.state.alert.level || \"warning\"}\n\t\t\t\t\t\tmessage={this.state.alert.message}\n\t\t\t\t\t/>\n\t\t\t\t}\n\n\t\t\t\t{window.editor_user && window.editor_user_auth && this.state.periods &&\n\t\t\t\t\t<Grid container alignItems=\"center\" spacing={2} style={{marginBottom: 10}}>\n\t\t\t\t\t\t<Grid item xs={12} sm={6}>\n\t\t\t\t\t\t\t{I18n.t(\"You have edited this line hours.\")}\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t<Grid item xs={6} sm={3}>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\t\tstyle={{width: \"100%\"}}\n\t\t\t\t\t\t\t\tonClick={() => this._onSend()}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<CloudUpload /> {I18n.t(\"Send to OSM\")}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t<Grid item xs={6} sm={3}>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\t\t\tstyle={{width: \"100%\"}}\n\t\t\t\t\t\t\t\tonClick={() => this._onCancel()}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Cancel /> {I18n.t(\"Cancel all\")}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Grid>\n\t\t\t\t\t</Grid>\n\t\t\t\t}\n\n\t\t\t\t{periods && periods.map((intv, pid) => (\n\t\t\t\t\t<Paper style={{padding: 10, marginBottom: 20}} key={pid}>\n\t\t\t\t\t\t<PeriodEditor\n\t\t\t\t\t\t\tperiod={intv}\n\t\t\t\t\t\t\tonValid={p => this._updatePeriod(pid, p)}\n\t\t\t\t\t\t\tonInvalid={() => this._busyPeriod(pid)}\n\t\t\t\t\t\t\tonDelete={() => this._deletePeriod(pid)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Paper>\n\t\t\t\t))}\n\n\t\t\t\t<Button\n\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\tstyle={{marginTop: 10}}\n\t\t\t\t\tonClick={() => this._addPeriod()}\n\t\t\t\t>\n\t\t\t\t\t<AlarmPlus /> {I18n.t(\"Add a new period\")}\n\t\t\t\t</Button>\n\n\t\t\t</div>;\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tif(this.props.editedPeriods) {\n\t\t\tthis.setState({ periods: this.props.editedPeriods });\n\t\t}\n\n\t\tif(!window.editor_user || !window.editor_user_auth) {\n\t\t\tthis.setState({ alert: { level: \"info\", message: I18n.t(\"You have to be connected to edit line hours\") }, notConnectedAlert: true });\n\t\t}\n\n\t\tthis.psTokenLogin = PubSub.subscribe(\"APP.USER.READY\", (msg, data) => {\n\t\t\tif(data && this.state.notConnectedAlert) {\n\t\t\t\tthis.setState({ alert: null, notConnectedAlert: false });\n\t\t\t}\n\t\t});\n\n\t\tthis.psTokenLogout = PubSub.subscribe(\"APP.USER.LOGOUT\", (msg, data) => {\n\t\t\tif(!this.state.notConnectedAlert) {\n\t\t\t\tthis.setState({ alert: { level: \"info\", message: I18n.t(\"You have to be connected to edit line hours\") }, notConnectedAlert: true });\n\t\t\t}\n\t\t});\n\t}\n\n\tcomponentDidUpdate(prevProps) {\n\t\tif(!deepEqual(this.props.editedPeriods, this.state.periods)) {\n\t\t\tthis.setState({ periods: this.props.editedPeriods });\n\t\t}\n\n\t\tif(!this.state.notConnectedAlert && (!window.editor_user || !window.editor_user_auth)) {\n\t\t\tthis.setState({ alert: { level: \"info\", message: I18n.t(\"You have to be connected to edit line hours\") }, notConnectedAlert: true });\n\t\t}\n\n\t\tif(this.state.notConnectedAlert && window.editor_user && window.editor_user_auth) {\n\t\t\tthis.setState({ alert: null, notConnectedAlert: false });\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif(this.psTokenLogin) {\n\t\t\tPubSub.unsubscribe(\"APP.USER.READY\", this.psTokenLogin);\n\t\t}\n\t\tif(this.psTokenLogout) {\n\t\t\tPubSub.unsubscribe(\"APP.USER.LOGOUT\", this.psTokenLogout);\n\t\t}\n\t}\n}\n\nexport default withRouter(HoursEditor);\n","import React, { Component } from 'react';\nimport Button from '@material-ui/core/Button';\nimport CalendarEdit from 'mdi-react/CalendarEditIcon';\nimport I18n from 'i18nline/lib/i18n';\nimport InAlert from './InAlert';\nimport HoursEditor from './HoursEditor';\nimport { Link } from 'react-router-dom';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\n\n/**\n * ContentTripLine is a component for both seeing trips of a line, and viewing/editing line hours.\n */\nclass ContentTripLine extends Component {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.state = {\n\t\t\ttab: 0\n\t\t};\n\t}\n\n\trender() {\n\t\tconst line = this.props.selectedLine && this.props.lines && this.props.lines[this.props.selectedLine] ? this.props.lines[this.props.selectedLine] : null;\n\t\tconst trip = line && this.props.selectedTrip && line.trips[this.props.selectedTrip] ? line.trips[this.props.selectedTrip] : null;\n\n\t\treturn <div>\n\t\t\t<Tabs\n\t\t\t\tvalue={trip ? 0 : this.state.tab}\n\t\t\t\tonChange={(e, newval) => this.setState({ tab: newval })}\n\t\t\t\tindicatorColor=\"primary\"\n\t\t\t\ttextColor=\"primary\"\n\t\t\t>\n\t\t\t\t<Tab label={I18n.t(\"Hours\")} />\n\t\t\t\t{!trip && line.trips && <Tab label={I18n.t(\"Trips\")} />}\n\t\t\t</Tabs>\n\n\t\t\t{((!trip && this.state.tab === 0) || trip) && <div>\n\t\t\t\t{trip &&\n\t\t\t\t\t<InAlert\n\t\t\t\t\t\tmessage={I18n.t(\"This trip belongs to line %{line}. If all trips of this line have similar hours, please edit line information instead of trips ones.\", { line: line.ref })}\n\t\t\t\t\t/>\n\t\t\t\t}\n\n\t\t\t\t<HoursEditor\n\t\t\t\t\tlinetrip={trip || line}\n\t\t\t\t\trelid={trip ? this.props.selectedTrip : this.props.selectedLine}\n\t\t\t\t\tdataManager={this.props.dataManager}\n\t\t\t\t\teditedPeriods={this.props.edits}\n\t\t\t\t\tonEdit={periods => this.props.onEdit(periods)}\n\t\t\t\t/>\n\t\t\t</div>}\n\n\t\t\t{!trip && this.state.tab === 1 && <div>\n\t\t\t\t{(line.opening_hours || line.interval) &&\n\t\t\t\t\t<InAlert\n\t\t\t\t\t\tmessage={I18n.t(\"This line already has hours defined. You may not need to add hours on trips if they are similar.\")}\n\t\t\t\t\t/>\n\t\t\t\t}\n\n\t\t\t\t<List>\n\t\t\t\t\t{Object.entries(line.trips).map(e => {\n\t\t\t\t\t\tconst [ tid, t ] = e;\n\t\t\t\t\t\treturn <ListItem key={tid}>\n\t\t\t\t\t\t\t<ListItemAvatar>\n\t\t\t\t\t\t\t\t<transport-thumbnail\n\t\t\t\t\t\t\t\t\tdata-transport-mode={line.type}\n\t\t\t\t\t\t\t\t\tdata-transport-line-code={t.ref || line.ref}\n\t\t\t\t\t\t\t\t\tdata-transport-line-color={t.colour || line.colour}>\n\t\t\t\t\t\t\t\t</transport-thumbnail>\n\t\t\t\t\t\t\t</ListItemAvatar>\n\t\t\t\t\t\t\t<ListItemText\n\t\t\t\t\t\t\t\tprimary={I18n.t(\"Destination : %{dest}\", { dest: t.to })}\n\t\t\t\t\t\t\t\tsecondary={I18n.t(\"From : %{from}\", { from: t.from })}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<ListItemSecondaryAction>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tedge=\"end\"\n\t\t\t\t\t\t\t\t\tcolor=\"secondary\"\n\t\t\t\t\t\t\t\t\tcomponent={Link}\n\t\t\t\t\t\t\t\t\tto={\"/line/\"+this.props.selectedLine+\"/trip/\"+tid}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<CalendarEdit /> {I18n.t(\"Edit hours\")}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</ListItemSecondaryAction>\n\t\t\t\t\t\t</ListItem>;\n\t\t\t\t\t})}\n\t\t\t\t</List>\n\t\t\t</div>}\n\t\t</div>;\n\t}\n}\n\nexport default ContentTripLine;\n","import React, { Component } from 'react';\nimport Breadcrumbs from '@material-ui/core/Breadcrumbs';\nimport I18n from 'i18nline/lib/i18n';\nimport { Link } from 'react-router-dom';\nimport Paper from '@material-ui/core/Paper';\n\n/**\n * NavLines is a component for showing currently selected transport line.\n * It allows also to go back in navigation.\n */\nclass NavLines extends Component {\n\trender() {\n\t\tconst line = this.props.selectedLine && this.props.lines && this.props.lines[this.props.selectedLine] ? this.props.lines[this.props.selectedLine] : null;\n\t\tconst trip = line && this.props.selectedTrip && line.trips[this.props.selectedTrip] ? line.trips[this.props.selectedTrip] : null;\n\t\tconst stLink = {textDecoration: \"none\", color: \"inherit\"}\n\n\t\treturn <Paper style={{padding: 10}}><Breadcrumbs separator=\" / \" aria-label=\"Breadcrumb\" style={{display: \"flex\", justifyContent: \"center\"}}>\n\t\t\t<Link to=\"/\" style={stLink}>\n\t\t\t\t{I18n.t(\"Home\")}\n\t\t\t</Link>\n\n\t\t\t{line && line.rawTags.route_master &&\n\t\t\t\t<Link to={\"/line/\"+this.props.selectedLine} style={stLink}>\n\t\t\t\t\t{I18n.t(\"Line\")}\n\t\t\t\t\t<transport-thumbnail\n\t\t\t\t\t\tdata-transport-mode={line.type}\n\t\t\t\t\t\tdata-transport-line-code={line.ref}\n\t\t\t\t\t\tdata-transport-line-color={line.colour}>\n\t\t\t\t\t</transport-thumbnail>\n\t\t\t\t</Link>\n\t\t\t}\n\n\t\t\t{line && !line.rawTags.route_master && !trip &&\n\t\t\t\t<Link to={\"/line/\"+this.props.selectedLine} style={stLink}>\n\t\t\t\t\t{I18n.t(\"Trip\")}\n\t\t\t\t\t<transport-thumbnail\n\t\t\t\t\t\tdata-transport-mode={line.type}\n\t\t\t\t\t\tdata-transport-line-code={line.ref}\n\t\t\t\t\t\tdata-transport-line-color={line.colour}\n\t\t\t\t\t\tdata-transport-destination={line.to}>\n\t\t\t\t\t</transport-thumbnail>\n\t\t\t\t</Link>\n\t\t\t}\n\n\t\t\t{line && trip &&\n\t\t\t\t<Link to={\"/line/\"+this.props.selectedLine+\"/trip/\"+this.props.selectedTrip} style={stLink}>\n\t\t\t\t\t{I18n.t(\"Trip\")}\n\t\t\t\t\t<transport-thumbnail\n\t\t\t\t\t\tdata-transport-mode={line.type}\n\t\t\t\t\t\tdata-transport-line-code={line.ref}\n\t\t\t\t\t\tdata-transport-line-color={line.colour}\n\t\t\t\t\t\tdata-transport-destination={trip.to}>\n\t\t\t\t\t</transport-thumbnail>\n\t\t\t\t</Link>\n\t\t\t}\n\t\t</Breadcrumbs></Paper>;\n\t}\n}\n\nexport default NavLines;\n","import React, { Component } from 'react';\nimport Button from '@material-ui/core/Button';\nimport I18n from 'i18nline/lib/i18n';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport PubSub from 'pubsub-js';\n\nconst ID_URL = \"https://openstreetmap.org/edit\";\nconst JOSM_URL = \"http://localhost:8111\";\n\nMath.toRadians = function(degrees) {\n\treturn degrees * Math.PI / 180;\n};\n\nMath.toDegrees = function(radians) {\n\treturn radians * 180 / Math.PI;\n};\n\n/**\n * EditorsMenu component display editor selection menu, and launch appropriate action.\n */\nclass EditorsMenu extends Component {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.state = {\n\t\t\topen: false,\n\t\t\tanchor: false\n\t\t};\n\t}\n\n\t/**\n\t * Close the menu\n\t * @private\n\t */\n\t_onClose() {\n\t\tthis.setState({ open: false, anchor: null });\n\t}\n\n\t/**\n\t * Opens and zoom in JOSM on current picture area.\n\t * @private\n\t */\n\t_editJOSM() {\n\t\tlet url = JOSM_URL + \"/load_object?\";\n\n\t\tif(this.props.relation) {\n\t\t\turl += \"&objects=r\" + this.props.relation + \"&relation_members=true\";\n\t\t}\n\n\t\tfetch(url)\n\t\t.then(response => {\n\t\t\tPubSub.publish(\"UI.MESSAGE.BASIC\", { type: \"info\", message: I18n.t(\"Opened in JOSM\") });\n\t\t})\n\t\t.catch(error => {\n\t\t\tconsole.error(error);\n\t\t\tPubSub.publish(\"UI.MESSAGE.BASIC\", { type: \"error\", message: I18n.t(\"Can't open in JOSM, are you sure remote control is enabled ?\") });\n\t\t});\n\t}\n\n\t/**\n\t * Opens ID editor on current picture area.\n\t * @private\n\t */\n\t_editId() {\n\t\tlet url = ID_URL + \"#\";\n\n\t\tconst params = {\n// \t\t\tmap: \"21/\"+this.props.feature.coordinates.join(\"/\"),\n\t\t\thashtags: \"#\"+window.EDITOR_NAME.replace(/ /g, \"_\")\n\t\t};\n\n\t\tif(this.props.relation) {\n\t\t\tparams.id = \"r\"+this.props.relation;\n\t\t}\n\n\t\turl += Object.entries(params).map(p => p[0] + \"=\" + encodeURIComponent(p[1])).join(\"&\");\n\n\t\twindow.open(\n\t\t\turl,\n\t\t\t\"_blank\"\n\t\t).focus();\n\t}\n\n\t_click(editor) {\n\t\tthis._onClose();\n\t\tswitch(editor) {\n\t\t\tcase \"id\":\n\t\t\t\tthis._editId();\n\t\t\t\tbreak;\n\t\t\tcase \"josm\":\n\t\t\t\tthis._editJOSM();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\t}\n\n\trender() {\n\t\tconst editors = [\n// \t\t\t{ id: \"id\", name: I18n.t(\"iD\"), tip: I18n.t(\"Recommended, simplest one\") },\n\t\t\t{ id: \"josm\", name: I18n.t(\"JOSM\"), tip: I18n.t(\"Most complete one\") }\n\t\t];\n\n\t\treturn <div style={{display: \"inline-block\"}}>\n\t\t\t<Button\n\t\t\t\tonClick={e => {\n\t\t\t\t\tif(editors.length > 1) {\n\t\t\t\t\t\tthis.setState({ open: true, anchor: e.currentTarget });\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis._click(editors[0].id);\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{editors.length > 1 ? I18n.t(\"Edit in external editor\") : I18n.t(\"Edit in %{editor}\", { editor: editors[0].name })}\n\t\t\t</Button>\n\n\t\t\t{editors.length > 1 && this.state.anchor &&\n\t\t\t\t<Menu\n\t\t\t\t\tid=\"editors-menu\"\n\t\t\t\t\tanchorEl={this.state.anchor}\n\t\t\t\t\topen={this.state.open}\n\t\t\t\t\tkeepMounted\n\t\t\t\t\tonClose={() => this._onClose()}\n\t\t\t\t>\n\t\t\t\t\t{editors.map(e => {\n\t\t\t\t\t\treturn <MenuItem key={e.id} onClick={() => this._click(e.id)}><ListItemText primary={e.name} secondary={e.tip} /></MenuItem>\n\t\t\t\t\t})}\n\t\t\t\t</Menu>\n\t\t\t}\n\t\t</div>;\n\t}\n}\n\nexport default EditorsMenu;\n","import React, { Component } from 'react';\nimport I18n from 'i18nline/lib/i18n';\nimport Paper from '@material-ui/core/Paper';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\n\n/**\n * TagsTable is a component for displaying OSM feature tags as a table.\n */\nclass TagsTable extends Component {\n\trender() {\n\t\treturn <Paper style={Object.assign({overflowX: \"auto\"}, this.props.style)}>\n\t\t\t<Table>\n\t\t\t\t<TableHead>\n\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t<TableCell>{I18n.t(\"Key\")}</TableCell>\n\t\t\t\t\t\t<TableCell>{I18n.t(\"Value\")}</TableCell>\n\t\t\t\t\t</TableRow>\n\t\t\t\t</TableHead>\n\t\t\t\t\n\t\t\t\t<TableBody>\n\t\t\t\t\t{Object.entries(this.props.tags).map((e, i) => (\n\t\t\t\t\t\t<TableRow key={i}>\n\t\t\t\t\t\t\t<TableCell>{e[0]}</TableCell>\n\t\t\t\t\t\t\t<TableCell>{e[1]}</TableCell>\n\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t))}\n\t\t\t\t</TableBody>\n\t\t\t</Table>\n\t\t</Paper>;\n\t}\n}\n\nexport default TagsTable;\n","import React, { Component } from 'react';\nimport Button from '@material-ui/core/Button';\nimport CONFIG from '../config/config.json';\nimport EditorsMenu from './EditorsMenu';\nimport I18n from 'i18nline/lib/i18n';\nimport InAlert from './InAlert';\nimport TagsTable from './TagsTable';\n\n/**\n * SummaryTripLine is a component which displays a summary of given line/trip.\n * It allows to open external editor.\n */\nclass SummaryTripLine extends Component {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.state = {\n\t\t\tshowTags: false\n\t\t};\n\t}\n\n\trender() {\n\t\tconst line = this.props.selectedLine && this.props.lines && this.props.lines[this.props.selectedLine] ? this.props.lines[this.props.selectedLine] : null;\n\t\tconst trip = line && this.props.selectedTrip && line.trips[this.props.selectedTrip] ? line.trips[this.props.selectedTrip] : null;\n\t\tconst linetrip = trip || line;\n\n\t\treturn <div>\n\t\t\t<h2>\n\t\t\t\t<transport-thumbnail\n\t\t\t\t\tdata-transport-mode={line.type}\n\t\t\t\t\tdata-transport-line-code={line.ref}\n\t\t\t\t\tdata-transport-line-color={line.colour}>\n\t\t\t\t</transport-thumbnail>\n\t\t\t\t{trip ?\n\t\t\t\t\ttrip.name\n\t\t\t\t\t:\n\t\t\t\t\tline.name\n\t\t\t\t}\n\t\t\t</h2>\n\n\t\t\t<ul>\n\t\t\t\t<li>{I18n.t(\"Network\") + \" : \" + (line.network ? line.network : I18n.t(\"not set\"))}</li>\n\t\t\t\t<li>{I18n.t(\"Operator\") + \" : \" + (line.operator ? line.operator : I18n.t(\"not set\"))}</li>\n\t\t\t</ul>\n\n\t\t\t{linetrip && !isNaN(linetrip.defaultInterval) && linetrip.opens === \"unset\" &&\n\t\t\t\t<InAlert message={I18n.t(\"This line has no opening hours defined, existing intervals are applied 24/7.\")} />\n\t\t\t}\n\n\t\t\t{linetrip && linetrip.defaultInterval === \"unset\" && linetrip.otherIntervals === \"unset\" && typeof linetrip.opens === \"object\" &&\n\t\t\t\t<InAlert message={I18n.t(\"This line has no interval defined, but its opening hours are:\")+\" \"+linetrip.rawTags.opening_hours} />\n\t\t\t}\n\n\t\t\t{linetrip && linetrip.defaultInterval === \"unset\" && linetrip.otherIntervals === \"unset\" && linetrip.opens === \"unset\" &&\n\t\t\t\t<InAlert message={I18n.t(\"This line has no opening hours or interval defined, you can start adding periods\")} />\n\t\t\t}\n\n\t\t\t{linetrip && (linetrip.defaultInterval === \"invalid\" || linetrip.otherIntervals === \"invalid\" || linetrip.opens === \"invalid\") &&\n\t\t\t\t<InAlert level=\"warning\" message={I18n.t(\"Some attributes of this line are invalid, please check and correct hours.\")} />\n\t\t\t}\n\n\t\t\t{this.state.showTags &&\n\t\t\t\t<TagsTable tags={trip ? trip.rawTags : line.rawTags} style={{marginBottom: 20}}/>\n\t\t\t}\n\n\t\t\t<div style={{textAlign: \"right\"}}>\n\t\t\t\t<Button\n\t\t\t\t\tonClick={() => this.setState({ showTags: !this.state.showTags })}\n\t\t\t\t>\n\t\t\t\t\t{this.state.showTags ? I18n.t(\"Hide tags\") : I18n.t(\"See all tags\")}\n\t\t\t\t</Button>\n\t\t\t\t<Button\n\t\t\t\t\thref={CONFIG.osm_api_url+\"/relation/\"+(trip ? this.props.selectedTrip : this.props.selectedLine)}\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t>\n\t\t\t\t\t{I18n.t(\"See on OSM.org\")}\n\t\t\t\t</Button>\n\n\t\t\t\t<EditorsMenu relation={this.props.selectedTrip || this.props.selectedLine} />\n\t\t\t</div>\n\t\t</div>;\n\t}\n}\n\nexport default SummaryTripLine;\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport ContentLineTrip from './ContentLineTrip';\nimport I18n from 'i18nline/lib/i18n';\nimport { Prompt } from 'react-router';\nimport NavLines from './NavLines';\nimport SummaryLineTrip from './SummaryLineTrip';\n\n/**\n * LineTrip component manages the whole display of lines or trips.\n */\nclass LineTrip extends Component {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.state = {\n\t\t\tedits: null\n\t\t};\n\t}\n\n\trender() {\n\t\tconst theProps = Object.assign({}, this.props, {\n\t\t\tselectedLine: this.props.match.params.lid,\n\t\t\tselectedTrip: this.props.match.params.tid\n\t\t});\n\n\t\treturn theProps.selectedLine && theProps.lines && theProps.lines[theProps.selectedLine] ? <div>\n\t\t\t<Prompt\n\t\t\t\twhen={this.state.edits !== null}\n\t\t\t\tmessage={location => (\n\t\t\t\t\tlocation.pathname === theProps.history.location.pathname ?\n\t\t\t\t\ttrue\n\t\t\t\t\t: I18n.t(\"You have unsaved edits, if you leave these edits will be lost. Are you sure you want to leave the page ?\")\n\t\t\t\t)}\n\t\t\t/>\n\n\t\t\t<NavLines {...theProps} />\n\t\t\t<SummaryLineTrip {...theProps} />\n\n\t\t\t<ContentLineTrip\n\t\t\t\t{...theProps}\n\t\t\t\tedits={this.state.edits}\n\t\t\t\tonEdit={periods => this.setState({ edits: periods })}\n\t\t\t/>\n\t\t</div> : <div></div>;\n\t}\n\n\t/**\n\t * Redirects to loader if relation data is missing\n\t * @private\n\t */\n\t_checkDataLoaded() {\n\t\tif(!this.props.match.params.lid || !this.props.lines || !this.props.lines[this.props.match.params.lid]) {\n\t\t\tthis.props.history.push(\"/load/\"+this.props.match.params.lid);\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis._checkDataLoaded();\n\t}\n\n\tcomponentDidUpdate() {\n\t\tthis._checkDataLoaded();\n\t}\n}\n\nexport default withRouter(LineTrip);\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport I18n from 'i18nline/lib/i18n';\nimport PubSub from 'pubsub-js';\n\n/**\n * Login dialog component informs user on the login procedure of OpenStreetMap.\n * It allows user to go to connect page on OSM, or create an account.\n */\nclass LoginDialogComponent extends Component {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.state = {\n\t\t\topen: false\n\t\t};\n\n\t\t/**\n\t\t * Event when the user wants to login.\n\t\t * @event APP.USER.WANTSLOGIN\n\t\t */\n\t\tPubSub.subscribe(\"APP.USER.WANTSLOGIN\", (msg, data) => {\n\t\t\tdata = data || {};\n\t\t\tthis.setState({ open: true });\n\t\t});\n\t}\n\n\t/**\n\t * Handler for login button click.\n\t * @private\n\t */\n\t_loginClicked() {\n\t\tPubSub.publish(\"APP.USER.LOGIN\");\n\t\tthis._closeDialog(false);\n\t}\n\n\t/**\n\t * Handler for closing dialog\n\t * @private\n\t */\n\t_closeDialog(backToHome) {\n\t\tthis.setState({ open: false });\n\n\t\tif(backToHome && this.props.history) {\n\t\t\tthis.props.history.push('/');\n\t\t}\n\t}\n\n\trender() {\n\t\treturn <Dialog\n\t\t\topen={this.state.open}\n\t\t\tonClose={() => this._closeDialog(true)}\n\t\t>\n\t\t\t<DialogTitle>{I18n.t(\"Connect to OpenStreetMap\")}</DialogTitle>\n\t\t\t<DialogContent>\n\t\t\t\t<DialogContentText>\n\t\t\t\t\t{I18n.t(\"%{editor} uses OpenStreetMap accounts. Please connect to OSM or create an account in order to be able to contribute.\", { editor: window.EDITOR_NAME })}\n\t\t\t\t</DialogContentText>\n\t\t\t</DialogContent>\n\t\t\t<DialogActions>\n\t\t\t\t<Button onClick={() => this._closeDialog(true)} color=\"default\">\n\t\t\t\t\t{I18n.t(\"Cancel\")}\n\t\t\t\t</Button>\n\t\t\t\t<Button onClick={() => this._loginClicked()} color=\"primary\" autoFocus>\n\t\t\t\t\t{I18n.t(\"Login or create account\")}\n\t\t\t\t</Button>\n\t\t\t</DialogActions>\n\t\t</Dialog>;\n\t}\n}\n\nexport default withRouter(LoginDialogComponent);\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\n\n/**\n * Line list component shows a list of transport lines.\n */\nclass LineList extends Component {\n\trender() {\n\t\treturn this.props.data ?\n\t\t<List component=\"nav\">\n\t\t\t{Object.entries(this.props.data)\n\t\t\t.sort((a,b) => parseInt(b[1].ts) - parseInt(a[1].ts))\n\t\t\t.map(e => {\n\t\t\t\tconst [ lid, line ] = e;\n\t\t\t\treturn <ListItem\n\t\t\t\t\tbutton\n\t\t\t\t\tcomponent={Link}\n\t\t\t\t\tkey={lid}\n\t\t\t\t\tto={\"/line/\"+lid}\n\t\t\t\t>\n\t\t\t\t\t<ListItemAvatar>\n\t\t\t\t\t\t<transport-thumbnail\n\t\t\t\t\t\t\tdata-transport-mode={line.type}\n\t\t\t\t\t\t\tdata-transport-line-code={line.ref}\n\t\t\t\t\t\t\tdata-transport-line-color={line.colour}>\n\t\t\t\t\t\t</transport-thumbnail>\n\t\t\t\t\t</ListItemAvatar>\n\t\t\t\t\t<ListItemText\n\t\t\t\t\t\tprimary={line.name}\n\t\t\t\t\t\tsecondary={line.operator}\n\t\t\t\t\t/>\n\t\t\t\t</ListItem>;\n\t\t\t})}\n\t\t</List>\n\t\t: <div></div>;\n\t}\n}\n\nexport default LineList;\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport I18n from 'i18nline/lib/i18n';\nimport IconButton from '@material-ui/core/IconButton';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport { Link } from 'react-router-dom';\nimport LineList from './LineList';\nimport Magnify from 'mdi-react/MagnifyIcon';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\n\n/**\n * Welcome component is the main page content.\n * From there you can search for a particular relation.\n */\nclass Welcome extends Component {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.state = {\n\t\t\tsearchText: \"\"\n\t\t};\n\t}\n\n\trender() {\n\t\treturn <div>\n\t\t\t<div style={{marginTop: 30, marginBottom: 30}}>\n\t\t\t\t<Typography>{I18n.t(\"Busy Hours is a public transport editor for OpenStreetMap. You can easily edit details of public transport lines.\")}</Typography>\n\t\t\t\t<Typography>{I18n.t(\"To start, enter a transport line relation ID in the search field below.\")}</Typography>\n\t\t\t</div>\n\n\t\t\t<TextField\n\t\t\t\tid=\"relation-id-field\"\n\t\t\t\tref=\"relnumber\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tplaceholder=\"1234567\"\n\t\t\t\tvariant=\"outlined\"\n\t\t\t\tlabel={I18n.t(\"Relation ID\")}\n\t\t\t\tstyle={{width: \"100%\", marginBottom: 30}}\n\t\t\t\tvalue={this.state.searchText}\n\t\t\t\tonChange={e => this.setState({ searchText: e.target.value })}\n\t\t\t\tInputProps={{\n\t\t\t\t\tendAdornment: (\n\t\t\t\t\t\t<InputAdornment position=\"end\">\n\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\tcomponent={Link}\n\t\t\t\t\t\t\t\tto={\"/load/\"+this.state.searchText.trim()}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Magnify />\n\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t</InputAdornment>\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t/>\n\n\t\t\t{this.props.previousLines && Object.keys(this.props.previousLines).length > 0 && [\n\t\t\t\t<Typography key={0}>{I18n.t(\"Previously loaded lines\")}</Typography>\n\t\t\t\t,\n\t\t\t\t<LineList key={1} data={this.props.previousLines} />\n\t\t\t]}\n\t\t</div>;\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.refs.relnumber.addEventListener(\"keyup\", evt => {\n\t\t\tif(evt.key === \"Enter\") {\n\t\t\t\tthis.props.history.push(\"/load/\"+this.state.searchText.trim());\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport default withRouter(Welcome);\n","import React, { Component } from 'react';\nimport { HashRouter, Switch, Route } from 'react-router-dom';\nimport 'typeface-roboto';\nimport 'jungle_bus_web_components';\nimport { createMuiTheme } from '@material-ui/core/styles';\nimport { ThemeProvider } from '@material-ui/styles';\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers';\nimport Alert from './Alert';\nimport Container from '@material-ui/core/Container';\nimport DataLoader from './DataLoader';\nimport DateFnsUtils from '@date-io/date-fns';\nimport blue from '@material-ui/core/colors/blue';\nimport orange from '@material-ui/core/colors/orange';\nimport Header from './Header';\nimport LineTrip from './LineTrip';\nimport LoginDialog from './LoginDialog';\nimport Welcome from './Welcome';\n\nconst STORAGE_ID = \"previous_lines\";\n\n/**\n * Body is the view main class.\n * It creates all other component in cascade.\n */\nclass Body extends Component {\n\tconstructor() {\n\t\tsuper();\n\n\t\t// Set main colors of app\n\t\tthis._theme = createMuiTheme({\n\t\t\tpalette: {\n\n\t\t\t\tprimary: blue,\n\n\t\t\t\tsecondary: {\n\t\t\t\t\tlight: orange[500],\n\t\t\t\t\tmain: orange[800],\n\t\t\t\t\tdark: orange[900]\n\t\t\t\t},\n\n\t\t\t}\n\t\t});\n\n\t\tthis.state = {};\n\t}\n\n\t/**\n\t * Get the list of previously loaded lines from local storage\n\t * @private\n\t */\n\t_getPreviousLinesInStorage() {\n\t\treturn JSON.parse(window.localStorage.getItem(STORAGE_ID) || '{}');\n\t}\n\n\t_onDataLoaded(newData) {\n\t\tthis.setState({ lines: newData });\n\t\tconsole.log(\"Loaded data\", newData);\n\n\t\t// Append loaded data into localStorage\n\t\tconst inStore = this._getPreviousLinesInStorage();\n\t\tconst toAppend = {};\n\t\tObject.entries(newData).forEach(e => {\n\t\t\tconst [ id, val ] = e;\n\t\t\ttoAppend[id] = {\n\t\t\t\tcolour: val.colour,\n\t\t\t\tname: val.name,\n\t\t\t\tref: val.ref,\n\t\t\t\ttype: val.type,\n\t\t\t\toperator: val.operator,\n\t\t\t\tts: parseInt(Math.floor(Date.now() / 1000)) // To allow sort\n\t\t\t};\n\t\t});\n\n\t\ttry {\n\t\t\twindow.localStorage.setItem(STORAGE_ID, JSON.stringify(Object.assign(inStore, toAppend)));\n\t\t}\n\t\tcatch(e) {\n\t\t\ttry {\n\t\t\t\twindow.localStorage.clear();\n\t\t\t\twindow.localStorage.setItem(STORAGE_ID, JSON.stringify(toAppend));\n\t\t\t}\n\t\t\tcatch(e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t}\n\t}\n\n\trender() {\n\t\treturn <HashRouter>\n\t\t\t<MuiPickersUtilsProvider utils={DateFnsUtils}>\n\t\t\t\t<ThemeProvider theme={this._theme}>\n\t\t\t\t\t<Header {...this.state} />\n\n\t\t\t\t\t<Container maxWidth=\"md\" style={{marginTop: 20, marginBottom: 20}}><Switch>\n\t\t\t\t\t\t<Route\n\t\t\t\t\t\t\texact\n\t\t\t\t\t\t\tpath='/'\n\t\t\t\t\t\t\trender={props => (\n\t\t\t\t\t\t\t\t<Welcome\n\t\t\t\t\t\t\t\t\t{...props}\n\t\t\t\t\t\t\t\t\tpreviousLines={this._getPreviousLinesInStorage()}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<Route\n\t\t\t\t\t\t\texact\n\t\t\t\t\t\t\tpath={this.state.lines ? '/load/:rid' : ['/load/:rid', '/line/:rid', '/line/:lid/trip/:rid' ]}\n\t\t\t\t\t\t\trender={props => (\n\t\t\t\t\t\t\t\t<DataLoader\n\t\t\t\t\t\t\t\t\t{...props}\n\t\t\t\t\t\t\t\t\t{...this.props}\n\t\t\t\t\t\t\t\t\tonDataLoaded={d => this._onDataLoaded(d)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t{this.state.lines && [\n\t\t\t\t\t\t\t<Route\n\t\t\t\t\t\t\t\tkey={0}\n\t\t\t\t\t\t\t\texact path='/line/:lid'\n\t\t\t\t\t\t\t\trender={props => <LineTrip {...this.state} {...this.props} />}\n\t\t\t\t\t\t\t/>,\n\t\t\t\t\t\t\t<Route\n\t\t\t\t\t\t\t\tkey={1}\n\t\t\t\t\t\t\t\texact path='/line/:lid/trip/:tid'\n\t\t\t\t\t\t\t\trender={props => <LineTrip {...this.state} {...this.props} />}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t]}\n\t\t\t\t\t</Switch></Container>\n\n\t\t\t\t\t<LoginDialog />\n\n\t\t\t\t\t<Alert />\n\t\t\t\t</ThemeProvider>\n\t\t\t</MuiPickersUtilsProvider>\n\t\t</HashRouter>;\n\t}\n}\n\nexport default Body;\n","import CONFIG from '../config/config.json';\nimport OsmRequest from 'osm-request';\nimport PACKAGE from '../../package.json';\nimport TransportHours from 'transport-hours';\n\nconst VALID_MODES = [ \"bus\", \"coach\", \"train\", \"subway\", \"monorail\", \"trolleybus\", \"aerialway\", \"funicular\", \"ferry\", \"tram\", \"share_taxi\", \"light_rail\", \"walking_bus\" ];\n\n/**\n * DataManager allows to communicate with OSM API.\n * It retrieves relations data, and allows to edit them back.\n */\nclass DataManager {\n\tconstructor() {\n\t\t// Create OSM Request\n\t\tthis._osmApi = new OsmRequest({\n\t\t\tendpoint: CONFIG.osm_api_url,\n\t\t\toauthConsumerKey: CONFIG.oauth_consumer_key,\n\t\t\toauthSecret: CONFIG.oauth_secret\n\t\t});\n\n\t\tthis._transportHours = new TransportHours();\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_getRelNumber(relid) {\n\t\treturn relid.split(\"/\")[1];\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_createSimplifiedLineTrip(relid, reltags, trips) {\n\t\tif(relid.includes(\"/\")) { relid = relid.split(\"/\")[1]; }\n\n\t\tconst result = Object.assign(\n\t\t\t{\n\t\t\t\tref: reltags.ref,\n\t\t\t\tname: reltags.name,\n\t\t\t\tcolour: reltags.colour,\n\t\t\t\tnetwork: reltags.network,\n\t\t\t\toperator: reltags.operator,\n\t\t\t\trawTags: reltags\n\t\t\t},\n\t\t\tthis._transportHours.tagsToHoursObject(reltags)\n\t\t);\n\n\t\tif(reltags.type === \"route\") {\n\t\t\tresult.type = reltags.route;\n\t\t\tresult.from = reltags.from;\n\t\t\tresult.to = reltags.to;\n\t\t}\n\t\telse {\n\t\t\tresult.type = reltags.route_master;\n\t\t\tresult.trips = trips;\n\t\t}\n\n\t\treturn { [relid]: result };\n\t}\n\n\t/**\n\t * Load all data related to given relation.\n\t * If relation is a route, loads route_master and all other routes.\n\t * If relation is a route_master, loads all routes in it.\n\t * @param {string} relationId The relation to load (example : \"relation/1234\")\n\t * @return {Promise} Resolves on loaded data (ready to use)\n\t */\n\tloadDataFromRelation(relationId) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis._osmApi.fetchElement(relationId)\n\t\t\t.then(relation => {\n\t\t\t\tconst relTags = this._osmApi.getTags(relation);\n\t\t\t\tconst transportMode = relTags.type === \"route\" ? relTags.route : relTags.route_master;\n\n\t\t\t\t// Check transport mode\n\t\t\t\tif(VALID_MODES.includes(transportMode)) {\n\t\t\t\t\t// Simple route\n\t\t\t\t\tif(relTags.type === \"route\") {\n\t\t\t\t\t\t// Fetch route_master\n\t\t\t\t\t\tthis._osmApi.fetchRelationsForElement(relationId)\n\t\t\t\t\t\t.then(parentRelations => {\n\t\t\t\t\t\t\tconst routeMasters = parentRelations.filter(r => this._osmApi.getTags(r).type === \"route_master\");\n\n\t\t\t\t\t\t\t// Single route master\n\t\t\t\t\t\t\tif(routeMasters.length === 1) {\n\t\t\t\t\t\t\t\t// Fetch other trips for this line\n\t\t\t\t\t\t\t\tconst otherTripsRel = routeMasters[0].member.filter(m => m.$.type === \"relation\" && m.$.ref !== relationId);\n\n\t\t\t\t\t\t\t\t// Other trips available\n\t\t\t\t\t\t\t\tif(otherTripsRel.length > 0) {\n\t\t\t\t\t\t\t\t\tPromise.all(\n\t\t\t\t\t\t\t\t\t\totherTripsRel.map(tr => this._osmApi.fetchElement(tr.$.type+\"/\"+tr.$.ref))\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t.then(otherTripsData => {\n\t\t\t\t\t\t\t\t\t\tresolve(this._createSimplifiedLineTrip(\n\t\t\t\t\t\t\t\t\t\t\trouteMasters[0].$.id,\n\t\t\t\t\t\t\t\t\t\t\tthis._osmApi.getTags(routeMasters[0]),\n\t\t\t\t\t\t\t\t\t\t\tObject.assign({}, ...otherTripsData.map(t => this._createSimplifiedLineTrip(t.$.id, this._osmApi.getTags(t), null)))\n\t\t\t\t\t\t\t\t\t\t));\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\t\t\t\t\treject(\"cant_get_trips\");\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// No other trips : send back route_master + original route\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tresolve(this._createSimplifiedLineTrip(\n\t\t\t\t\t\t\t\t\t\trouteMasters[0].$.id,\n\t\t\t\t\t\t\t\t\t\tthis._osmApi.getTags(routeMasters[0]),\n\t\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t\tthis._createSimplifiedLineTrip(relationId, relTags, null)\n\t\t\t\t\t\t\t\t\t\t]\n  \t\t\t\t\t\t\t\t\t));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// No route master : trip used as line\n\t\t\t\t\t\t\telse if(routeMasters.length === 0) {\n\t\t\t\t\t\t\t\tresolve(this._createSimplifiedLineTrip(relationId, relTags, null));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\treject(\"many_route_masters\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(e => {\n\t\t\t\t\t\t\treject(e);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t// Route master\n\t\t\t\t\telse if(relTags.type === \"route_master\") {\n\t\t\t\t\t\t// Fetch trips for this line\n\t\t\t\t\t\tconst tripsRel = relation.member.filter(m => m.$.type === \"relation\");\n\n\t\t\t\t\t\t// Other trips available\n\t\t\t\t\t\tif(tripsRel.length > 0) {\n\t\t\t\t\t\t\tPromise.all(\n\t\t\t\t\t\t\t\ttripsRel.map(tr => this._osmApi.fetchElement(tr.$.type+\"/\"+tr.$.ref))\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.then(otherTripsData => {\n\t\t\t\t\t\t\t\tresolve(this._createSimplifiedLineTrip(\n\t\t\t\t\t\t\t\t\trelationId,\n\t\t\t\t\t\t\t\t\tthis._osmApi.getTags(relation),\n\t\t\t\t\t\t\t\t\tObject.assign({}, ...otherTripsData.map(t => this._createSimplifiedLineTrip(t.$.id, this._osmApi.getTags(t), null)))\n\t\t\t\t\t\t\t\t));\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\t\t\treject(\"cant_get_trips\");\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// No other trips : send back route_master + original route\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\treject(\"no_trips\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treject(\"invalid_mode\");\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(e => {\n\t\t\t\treject(e);\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Upload period changes made on a relation to OSM.\n\t * @param {string} relationId The relation to update (example : \"relation/1234\")\n\t * @param {Object} allPeriods Object returned by HoursEditor, containing period array (days + intervals)\n\t * @return {Promise} Resolves on successful upload\n\t */\n\tasync saveRelationPeriods(relationId, allPeriods) {\n\t\t// Check if user is authenticated\n\t\tif(!window.editor_user || !window.editor_user_auth) {\n\t\t\treturn new Error(\"not_connected\");\n\t\t}\n\t\tthis._osmApi._auth = window.editor_user_auth;\n\n\t\t// Convert editor data into tags\n\t\tlet newTags;\n\t\ttry {\n\t\t\tnewTags = this._transportHours.intervalsObjectToTags(allPeriods);\n\t\t}\n\t\tcatch(e) {\n\t\t\treturn e;\n\t\t}\n\n\t\t// Retrieve data from OSM server (to ensure we have latest version)\n\t\tlet osmElement;\n\t\ttry {\n\t\t\tosmElement = await this._osmApi.fetchElement(relationId);\n\t\t\tif(!osmElement) { throw new Error(); }\n\t\t}\n\t\tcatch(e) {\n\t\t\tconsole.error(e);\n\t\t\treturn new Error(\"cant_find_relation\");\n\t\t}\n\n\t\t// Create changeset\n\t\tlet changesetId;\n\t\ttry {\n\t\t\tchangesetId = await this._osmApi.createChangeset(\n\t\t\t\twindow.EDITOR_NAME+' '+PACKAGE.version,\n\t\t\t\t\"Changed hours/interval of public transport route \"+relationId,\n\t\t\t\t{ host: window.EDITOR_URL }\n\t\t\t);\n\t\t}\n\t\tcatch(e) {\n\t\t\tconsole.error(e);\n\t\t\treturn new Error(\"changeset_failed\");\n\t\t}\n\n\t\t// Send data to OSM\n\t\tif(newTags && changesetId && osmElement) {\n\t\t\tosmElement = this._osmApi.setTags(osmElement, newTags);\n\t\t\tosmElement = this._osmApi.setTimestampToNow(osmElement);\n\n\t\t\tlet result;\n\t\t\ttry {\n\t\t\t\tresult = await this._osmApi.sendElement(osmElement, changesetId);\n\t\t\t\tif(isNaN(result)) {\n\t\t\t\t\tthrow new Error(\"Version number invalid\", result);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch(e) {\n\t\t\t\tconsole.error(e);\n\t\t\t\treturn new Error(\"sending_failed\");\n\t\t\t}\n\n\t\t\t// Close changeset\n\t\t\ttry {\n\t\t\t\tawait this._osmApi.closeChangeset(changesetId);\n\t\t\t}\n\t\t\tcatch(e) {\n\t\t\t\tconsole.error(\"Changeset was not closed, will be automatically closed after 30 minutes\");\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\t}\n}\n\nexport default DataManager;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Body from './view/Body';\nimport CONFIG from './config/config.json';\nimport DataManager from './ctrl/DataManager';\nimport I18n from 'i18nline/lib/i18n';\nimport OsmAuth from 'osm-auth';\nimport PubSub from 'pubsub-js';\n\n/*\n * Global variables definition\n */\nwindow.EDITOR_NAME = CONFIG.editor_name;\nconst LOCALES = [ \"en\", \"fr\" ];\nwindow.EDITOR_URL = window.location.origin + window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/')) + \"/\";\n\n/**\n * App is the application starter.\n * It creates mostly everything.\n */\nclass App {\n\tconstructor() {\n\t\tthis._initI18n();\n\t\tthis._initCtrl();\n\t\tthis._initView();\n\t\tthis._initAuth();\n\t}\n\n\t/**\n\t * Initializes internationalization system\n\t * @private\n\t */\n\t_initI18n() {\n\t\tlet locale = null;\n\t\tif(window.navigator.languages) {\n\t\t\tfor(const l of window.navigator.languages) {\n\t\t\t\tif(LOCALES.includes(l)) {\n\t\t\t\t\tlocale = l;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tI18n.locale = locale || window.navigator.userLanguage || window.navigator.language;\n\t\tI18n.fallbacks = true;\n\n\t\t//Load translation files\n\t\tfor(const l of LOCALES) {\n\t\t\tObject.assign(I18n.translations, require(\"./config/locales/\"+l.replace(\"-\", \"_\")+\".json\"));\n\t\t}\n\t}\n\n\t/**\n\t * Creates controller objects.\n\t * @private\n\t */\n\t_initCtrl() {\n\t\tthis._dataManager = new DataManager();\n\t}\n\n\t/**\n\t * Create view components\n\t * @private\n\t */\n\t_initView() {\n\t\tReactDOM.render(<Body dataManager={this._dataManager} />, document.getElementById('root'));\n\t\tdocument.title=window.EDITOR_NAME;\n\t}\n\n\t/**\n\t * Launches authentication process\n\t * @private\n\t */\n\t_initAuth() {\n\t\tconst opts = {\n\t\t\turl: CONFIG.osm_api_url,\n\t\t\toauth_consumer_key: CONFIG.oauth_consumer_key,\n\t\t\toauth_secret: CONFIG.oauth_secret,\n\t\t\tlanding: window.EDITOR_URL + window.location.hash,\n\t\t\tsinglepage: true\n\t\t};\n\t\twindow.editor_user_auth = OsmAuth(opts);\n\n\t\tconst params = this._readURLParams(window.location.href);\n\t\tconst token = params.oauth_token || localStorage.getItem(\"oauth_token\") || null;\n\n\t\tif(token) {\n\t\t\twindow.editor_user_auth.bootstrapToken(token, () => {\n\t\t\t\tthis._checkAuth();\n\t\t\t\twindow.history.pushState({}, \"\", window.location.href.replace(\"?oauth_token=\"+token, \"\"));\n\t\t\t\tlocalStorage.setItem(\"oauth_token\", token);\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\t//Check if we receive auth token\n\t\t\tthis._checkAuth();\n\t\t\tthis.authWait = setInterval(this._checkAuth.bind(this), 100);\n\t\t}\n\n\t\t/**\n\t\t * Event for logging in user\n\t\t * @event APP.USER.LOGIN\n\t\t * @memberof App\n\t\t */\n\t\tPubSub.subscribe(\"APP.USER.LOGIN\", (msg, data) => {\n\t\t\topts.landing = window.EDITOR_URL + window.location.hash;\n\t\t\twindow.editor_user_auth.options(opts);\n\n\t\t\tif(!window.editor_user_auth.authenticated()) {\n\t\t\t\twindow.editor_user_auth.authenticate((err, res) => {\n\t\t\t\t\tif(err) {\n\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\talert(I18n.t(\"Oops ! Something went wrong when trying to log you in\"));\n\t\t\t\t\t\tPubSub.publish(\"APP.USER.LOGOUT\");\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis._checkAuth();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t/**\n\t\t * Event for logging out user\n\t\t * @event APP.USER.LOGOUT\n\t\t * @memberof App\n\t\t */\n\t\tPubSub.subscribe(\"APP.USER.LOGOUT\", (msg, data) => {\n\t\t\tif(window.editor_user_auth && window.editor_user_auth.authenticated()) {\n\t\t\t\twindow.editor_user_auth.logout();\n\t\t\t}\n\n\t\t\twindow.editor_user = null;\n\t\t\tlocalStorage.removeItem(\"oauth_token\");\n\t\t});\n\t}\n\n\t/**\n\t * Check if authentication happened\n\t * @private\n\t */\n\t_checkAuth() {\n\t\tif(window.editor_user_auth.authenticated()) {\n\t\t\tif(this.authWait) {\n\t\t\t\tclearInterval(this.authWait);\n\t\t\t}\n\n\t\t\t//Get user details\n\t\t\twindow.editor_user_auth.xhr({\n\t\t\t\tmethod: 'GET',\n\t\t\t\tpath: '/api/0.6/user/details'\n\t\t\t}, (err, details) => {\n\t\t\t\tif(err) {\n\t\t\t\t\tconsole.log(err);\n\t\t\t\t\twindow.editor_user_auth.logout();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttry {\n\t\t\t\t\t\twindow.editor_user = {\n\t\t\t\t\t\t\tid: details.firstChild.childNodes[1].attributes.id.value,\n\t\t\t\t\t\t\tname: details.firstChild.childNodes[1].attributes.display_name.value,\n\t\t\t\t\t\t\tauth: window.editor_user_auth\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * Event when user has been successfully logged in\n\t\t\t\t\t\t * @event APP.USER.READY\n\t\t\t\t\t\t * @memberof App\n\t\t\t\t\t\t */\n\t\t\t\t\t\tPubSub.publish(\"APP.USER.READY\", { username: window.editor_user.name });\n\t\t\t\t\t\tconsole.log(\"Logged in as\", window.editor_user.name);\n\t\t\t\t\t}\n\t\t\t\t\tcatch(e) {\n\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t\tPubSub.publish(\"APP.USER.LOGOUT\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Parse URL parameters\n\t * @private\n\t */\n\t_readURLParams(str) {\n\t\tconst u = str.split('?');\n\n\t\tif(u.length > 1) {\n\t\t\tconst p = u[1].split('#')[0];\n\n\t\t\treturn p.split('&').filter(function (pair) {\n\t\t\t\treturn pair !== '';\n\t\t\t}).reduce(function(obj, pair){\n\t\t\t\tvar parts = pair.split('=');\n\t\t\t\tobj[decodeURIComponent(parts[0])] = (null === parts[1]) ?\n\t\t\t\t\t'' : decodeURIComponent(parts[1]);\n\t\t\t\treturn obj;\n\t\t\t}, {});\n\t\t}\n\t\telse {\n\t\t\treturn {};\n\t\t}\n\t}\n}\n\n// Create app\nnew App();\n"],"sourceRoot":""}